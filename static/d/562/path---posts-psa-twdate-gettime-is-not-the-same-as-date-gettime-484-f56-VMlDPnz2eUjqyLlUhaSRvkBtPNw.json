{"data":{"site":{"siteMetadata":{"author":{"name":"Samuel Chan","contacts":{"twitter":"#"}},"disqusShortname":"","subtitle":"Samuel Chan blogs here about the geekier parts of his life.","title":"Sam Does Blogs","url":"https://blog.samuelchan.dev"}},"markdownRemark":{"id":"45d23e37-1147-505e-be85-c8058eeeac4b","html":"<p>This one you need to file away in your brain folds, because it’s one of the many odd API deversions that exist in BPM vs native JS.</p>\n<p>From a quick glance at the <a href=\"https://www.ibm.com/support/knowledgecenter/en/SS8JB4_18.0.0/com.ibm.wbpm.ref.doc/ae/doc/JSAPI.html#TWDate\">documentation</a>, it looks like TWDate is a mirror of the native Javascript Date object. But if you look carefully at the documentation for the <code class=\"language-text\">getTime</code> method, it actually returns <em>seconds</em> since epoch, while the JS Date returns millisconds (even <code class=\"language-text\">java.util.Date</code> <code class=\"language-text\">getTime</code> returns milliseconds!)</p>\n<p>Run this in BPM somewhere if you want to confirm this with your own eyes:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> twDate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TWDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    jsDate <span class=\"token operator\">=</span> twDate<span class=\"token punctuation\">.</span><span class=\"token function\">toNativeDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ntw<span class=\"token punctuation\">.</span>local<span class=\"token punctuation\">.</span>differenceInMs <span class=\"token operator\">=</span> twDate<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span> <span class=\"token operator\">-</span> jsDate<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The code above subtracts a TWDate’s <code class=\"language-text\">getTime</code> return value multiplied by 1000 (to convert to milliseconds) and\nsubtracts the JS Date’s same value, to which you should get a value pretty close to zero.</p>\n<h2 id=\"thanksbut-how-does-this-affect-me\"><a href=\"#thanksbut-how-does-this-affect-me\" aria-label=\"thanksbut how does this affect me permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Thanks…but how does this affect me?</h2>\n<p>Bottom line, it’s not highly likely you’re going to mix these two date types. However, you may find yourself with an obscure bug you can’t figure out, such as calculating the time difference between two dates - it might be this.</p>\n<p>You may find yourself needing to create a new date object, and it’s far more natural (at least for a JS dev such as myself) to use <code class=\"language-text\">new Date()</code> than <code class=\"language-text\">new TWDate()</code>, and you may accidentally find yourself writing this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> delta <span class=\"token operator\">=</span> tw<span class=\"token punctuation\">.</span>local<span class=\"token punctuation\">.</span>serviceResult<span class=\"token punctuation\">.</span>createdAt<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>and wondering why you have negative time differences.</p>\n<p>Just keep this in mind the next time your write a bit of date time code in BPM.</p>","fields":{"slug":"/posts/psa-twdate-gettime-is-not-the-same-as-date-gettime","tagSlugs":["/tag/javascript/","/tag/server-scripts/","/tag/ibm-bpm/","/tag/psa/","/tag/tips/"]},"frontmatter":{"date":"2019-03-03T05:06:20Z","description":"Be careful when calculating time when mixing your native and BPM date objects.","tags":["javascript","server scripts","IBM BPM","PSA","tips"],"title":"TWDate.getTime is not the same as Date.getTime"}}},"pageContext":{"slug":"/posts/psa-twdate-gettime-is-not-the-same-as-date-gettime"}}